<!DOCTYPE html>
<html>
{{- partial "printhead.html" . -}}
<body>
    <div class="section">
        <div class="columns is-centered">
            <div class="column is-half-desktop" style="border-radius: 1%; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)">
                <div class="container">
                    <div class="columns">
                        <div class="column is-half">
                            <h1 id="mainTitle" class="title is-bold"> {{ .Title }} </h1>
                            <p class="subtitle is-italic" style="margin-bottom: .5em;"> {{ .Params.Author }}</p>  
                            {{ partial "printmetadata.html" . }}
                            <p class="subtitle is-italic" style="margin-top: .5em;"> {{ .Params.Tagline }}</p>
                        </div>
                        <div class="column is-half">
                            <div class="is-pulled-right">
                                <figure class="image"> 
                                    <img style="border-radius: 3%; width: 128px; height: 128px" src={{ printf "%s%s" .Site.BaseURL .Params.Recipe_image }} alt="Placeholder image">
                                </figure>
                            </div>
                        </div>
                    </div>
                </div>
                <hr style="margin-top: .5em; margin-bottom: 1em;">
                <div class="container has-text-centered">    
                    {{ partial "printstatstable.html" . }}
                </div>
                <hr style="margin-top: 1em; margin-bottom: .5em;">
                {{ if .Params.steps }}
                <div class="content recipe-steps">
                    <h2>Steps</h2>
                    {{ range $index, $step := .Params.steps }}
                    <div class="box recipe-step">
                        {{ if $step.ingredients }}
                        <div class="columns">
                            <div class="column is-one-third">
                                <h4 class="title is-6">Ingredients</h4>
                                <ul class="recipe-ingredients">
                                    {{ range $step.ingredients }}
                                    {{ $isMap := reflect.IsMap . }}
                                    {{ if and $isMap (isset . "amount") }}
                                    {{ $unit := .unit | default "" }}
                                    {{ $unitPlural := .unit_plural | default "" }}
                                    {{ $item := .item | default "" }}
                                    {{ $note := .note | default "" }}
                                    {{ $scalable := true }}
                                    {{ if isset . "scalable" }}
                                    {{ $scalable = .scalable }}
                                    {{ end }}
                                    <li class="recipe-ingredient" data-scalable="{{ $scalable }}">
                                        <span class="recipe-ingredient-amount" data-base-amount="{{ .amount }}" data-base-unit="{{ $unit }}" data-base-unit-plural="{{ $unitPlural }}">{{ .amount }}{{ if $unit }} {{ $unit }}{{ end }}</span>{{ if $item }} <span class="recipe-ingredient-name">{{ $item }}</span>{{ end }}{{ if $note }}<span class="recipe-ingredient-note">, {{ $note }}</span>{{ end }}
                                    </li>
                                    {{ else if and $isMap (isset . "item") }}
                                    <li>{{ .item }}{{ if .note }}, {{ .note }}{{ end }}</li>
                                    {{ else }}
                                    <li>{{ . }}</li>
                                    {{ end }}
                                    {{ end }}
                                </ul>
                            </div>
                            <div class="column">
                                <h4 class="title is-6">Step {{ add $index 1 }}</h4>
                                <div class="recipe-step-text">
                                    {{ $step.text | markdownify }}
                                </div>
                            </div>
                        </div>
                        {{ else }}
                        <div>
                            <h4 class="title is-6">Step {{ add $index 1 }}</h4>
                            <div class="recipe-step-text">
                                {{ $step.text | markdownify }}
                            </div>
                        </div>
                        {{ end }}
                    </div>
                    {{ end }}
                </div>
                {{ if .Content }}
                <div class="content recipe-notes">
                    {{ .Content }}
                </div>
                {{ end }}
                {{ else }}
                <div class="content">
                    {{ .Content }}
                </div>
                {{ end }}
            </div>
        </div>
    </div>
</body>
{{ partial "printscript.html" }}
</html>
